import{e as C,a as k,v as g,o as _,c as a,i as w,B as v,t as m,n as d,f as U}from"./index.53ff058e.js";import{T as N}from"./Title.a581f7e6.js";import{a as $,I as B,N as I,B as M,n as S,s as r,t as A,r as y}from"./register.edd687ec.js";import{M as T,F as D}from"./FlexContainer.57bbbc3b.js";import{u as F}from"./accounts.5552f8fa.js";const L=m("<h1>Choose a username!</h1>"),O=m("<br>"),P=m("<h3>Choose your own <!>!</h3>");function W(h){let c=C(),i,n;return k(()=>{let e=n.children[0].children[0];d.username!=null&&(e.value=d.username);let t=()=>{e.value.length<3||e.value.length>20?i.setAttribute("disabled",""):i.removeAttribute("disabled")};t(),e.oninput=t,g(1,function(s){s?y(c):h.pageLoaded()})}),_(()=>{h.pageUnloading()}),[a(N,{children:"Sign Up"}),L.cloneNode(!0),O.cloneNode(!0),(()=>{const e=P.cloneNode(!0),t=e.firstChild,s=t.nextSibling;return s.nextSibling,w(e,a(T,{children:"username"}),s),e})(),a(D,{space:"around",style:{width:"400px"},get children(){return[a($,{get children(){return a(B,{ref(e){const t=n;typeof t=="function"?t(e):n=e},id:"username",type:"text",label:"Username",autocomplete:"off",style:{width:"calc(100% - 8px)"},maxlength:20})}}),a(I,{children:"Your username is public, make sure it does not contain any sensitive or personal information!"}),a(M,{get children(){return[a(v,{type:"action",function:function(){history.back()},children:"Go back"}),a(v,{ref(e){const t=i;typeof t=="function"?t(e):i=e},type:"action",function:function(){S(i,function(e,t){let s=n.children[0].children[0],l=s.value.toLowerCase(),p=0,f=function(){p++,p==3&&t()};if(!/^[A-Za-z0-9_]*$/.test(l))r(n,!1,"Can only contain letters, numbers, and underscores!"),e();else if(!/[a-zA-Z]/.test(l))r(n,!1,"Must at least contain one letter!"),e();else if(l.length<3||l.length>20)r(n,!1,"Must be at least 3 characters long, and cannot exceed 20 characters!"),e();else{var o=new XMLHttpRequest;o.open("GET","/lists/reserved_usernames.txt"),o.send(null),o.onloadend=function(){o.status===200?o.responseText.includes(l)&&(r(n,!1,"Username is reserved by the system!"),e()):(r(n,!1,"An error occured, please try again later!"),e()),f()},A(s.value).then(function(u){u&&(r(n,!1,"Profanity not allow!"),e()),f()}),F(s.value,function(u,x){u?x.usernameExists&&(r(n,!1,"Username already in-use!"),e()):(U("Error!","We couldn't get a valid response from the server!",[["Ok",function(R,b){b()}]]),e()),f()},!1,!0)}},function(){d.username=n.children[0].children[0].value,g(2,function(e){e?y(c):c("/user/register/password")})})},primary:!0,children:"Next"})]}})]}})]}export{W as default};
